# SQL и Реляционные СУБД. Введение в PostgreSQL. 

## Read Committed
По умолчанию используется этот уровень изоляции в PostgreSQL. 
1)  Начать новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции. В первой сессии добавить новую запись insert into persons(first_name, second_name) values('sergey', 'sergeev');  
сделать select * from persons во второй сессии  
видите ли вы новую запись и если да то почему?
**Во второй сессии мы видим:
postgres=# select * from persons;
 id | first_name | second_name
----+------------+-------------
  1 | ivan       | ivanov
  2 | petr       | petrov
(2 rows)
   Так как первая сессия сделала commit и зафиксировала вставку только первых двух строчек - их мы только и видим во второй сессии.**
   
2)  Завершить первую транзакцию - commit;  
сделать select * from persons во второй сессии  
видите ли вы новую запись и если да то почему?  
завершите транзакцию во второй сессии
После вставки третьей строчки в табличку, мы её увидим во второй транзакции только после того, как сделаем commit в первой сессии и зафиксируем изменения. 

***Примечание: запрос `SELECT` (без предложения `FOR UPDATE/SHARE`) видит только те данные, которые были зафиксированы до начала запроса; он никогда не увидит незафиксированных данных или изменений, внесённых в процессе выполнения запроса параллельными транзакциями. По сути запрос `SELECT` видит снимок базы данных в момент начала выполнения запроса.***

## Repeatable Read

1) В первой сессии добавляем новую запись insert into persons(first_name, second_name) values('vlada', 'vladova');  
сделать select * from persons во второй сессии  
видите ли вы новую запись и если да то почему?
**Вторая сессия не видит вставленную строчку первой сессии:
postgres=# select * from persons;
 id | first_name | second_name
----+------------+-------------
  1 | ivan       | ivanov
  2 | petr       | petrov
  5 | sergey     | sergeev
  7 | sveta      | svetova**

2) Завершить первую транзакцию - commit;  
сделать select * from persons во второй сессии  
видите ли вы новую запись и если да то почему? 
**Новую строчку не видит вторая сессия ни перед фиксированием транзакции, ни после.**

3) Завершить вторую транзакцию  
сделать select * from persons во второй сессии  
видите ли вы новую запись и если да то почему?
**postgres=# select * from persons;
 id | first_name | second_name
----+------------+-------------
  1 | ivan       | ivanov
  2 | petr       | petrov
  5 | sergey     | sergeev
  7 | sveta      | svetova
(4 rows)**

***Примечание: В режиме Repeatable Read видны только те данные, которые были зафиксированы до начала транзакции, но не видны незафиксированные данные и изменения, произведённые другими транзакциями в процессе выполнения данной транзакции. Таким образом, последовательные команды `SELECT` в _одной_ транзакции видят одни и те же данные; они не видят изменений, внесённых и зафиксированных другими транзакциями после начала их текущей транзакции.***
